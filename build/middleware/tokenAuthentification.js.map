{"version":3,"sources":["../../server/middleware/tokenAuthentification.js"],"names":["env","config","authToken","req","res","next","token","body","query","headers","jwt","verify","process","SECRET_KEY","err","decoded","status","json","message"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEAA,mBAAIC,MAAJ;;AAGA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAClC,MAAMC,KAAK,GAAGH,GAAG,CAACI,IAAJ,CAASD,KAAT,IAAkBH,GAAG,CAACK,KAAJ,CAAUF,KAA5B,IAAqCH,GAAG,CAACM,OAAJ,CAAY,gBAAZ,CAAnD,CADkC,CAElC;;AACA,MAAIH,KAAJ,EAAW;AACTI,6BAAIC,MAAJ,CAAWL,KAAX,EAAkBM,OAAO,CAACZ,GAAR,CAAYa,UAA9B,EAA0C,UAACC,GAAD,EAAMC,OAAN,EAAkB;AAC1D,UAAID,GAAJ,EAAS;AACPV,QAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX;AACAZ,QAAAA,GAAG,CAACa,IAAJ,CAAS;AACPD,UAAAA,MAAM,EAAE,QADD;AAEPE,UAAAA,OAAO,EAAE;AAFF,SAAT;AAID,OAND,MAMO;AACLf,QAAAA,GAAG,CAACY,OAAJ,GAAcA,OAAd;AACAV,QAAAA,IAAI;AACL;AACF,KAXD;AAYD,GAbD,MAaO;AACLD,IAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX;AACAZ,IAAAA,GAAG,CAACa,IAAJ,CAAS;AACPD,MAAAA,MAAM,EAAE,QADD;AAEPE,MAAAA,OAAO,EAAE;AAFF,KAAT;AAID;AACF,CAvBH;;eAyBehB,S","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport env from 'dotenv';\r\n\r\nenv.config();\r\n\r\n\r\nconst authToken = (req, res, next) => {\r\n    const token = req.body.token || req.query.token || req.headers['x-access-token'];\r\n    // decode the token generated by user payload during signin or signup\r\n    if (token) {\r\n      jwt.verify(token, process.env.SECRET_KEY, (err, decoded) => {\r\n        if (err) {\r\n          res.status(401);\r\n          res.json({\r\n            status: 'Failed',\r\n            message: 'Authentication failed. Token is either invalid or expired'\r\n          });\r\n        } else {\r\n          req.decoded = decoded;\r\n          next();\r\n        }\r\n      });\r\n    } else {\r\n      res.status(403);\r\n      res.json({\r\n        status: 'Failed',\r\n        message: 'wrong token. provide  a valid token'\r\n      });\r\n    }\r\n  };\r\n\r\nexport default authToken;"],"file":"tokenAuthentification.js"}